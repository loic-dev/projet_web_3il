window.addEventListener("load",(()=>{document.querySelector("body").classList.remove("preload")})),(()=>{let e="Millau-1",t=0;function n(){document.getElementById("testHidden").remove()}function d(e,t,d,i,s,a=0,o=!0){fetch("./Controllers/searchAdvert.php",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:e,rubric:t,instrument:d,level:i,canton:s,limit:a})}).then((function(e){return e.json()})).then((function(e){var t;o&&(document.getElementById("display_event").innerHTML=""),t=s,document.getElementById("search_title").innerText="Annonce : "+t,console.log(e),e.numberOfResult.forEach((e=>{document.getElementById(e[1]).setAttribute("var",e[0])})),e.advert<1&&a>0?(n(),function(){let e=document.createElement("div");e.classList.add("liner"),e.innerHTML="<p>Fin des resultats</p>",document.getElementById("display_event").appendChild(e)}()):a>0?(n(),l(e.advert)):l(e.advert)})).catch((function(e){console.log(e)}))}function l(n){n.forEach((e=>{!function(e){let t,n=document.createElement("a");n.classList.add("atelier"),n.id=e.IdAdvert,n.href="./advert?q="+e.IdAdvert,t=""===e.Picture1?"/public/media/NoPic.png":e.Picture1.substring(0,e.Picture1.indexOf("."))+".webp",n.innerHTML=`\n          <div class="photo-container" style="background-image:url(${t})"></div>\n          <div class="adverts-body-container">\n              <div class="a-header">\n                  <div class="title-ad-container">\n                      <span class="a-title">${e.Title}</span>\n                      <span class="a-inst">${e.Instrument}</span>\n                  </div>\n                  <span class="a-address">${e.Adress}</span>\n              </div>\n          </div>\n    `,document.getElementById("display_event").appendChild(n)}(e)})),function(){let n=!1,l=document.createElement("span");l.id="testHidden",l.classList.add("liner"),l.innerText="Chargement de nouvelles annonces ...",l.style="height:15px",document.getElementById("display_event").appendChild(l),new IntersectionObserver((function(l){if(!0===l[0].isIntersecting&&!n){n=!0;let l=document.getElementById("inputSearchAdvert").value,i=document.getElementById("rubric-select").value,s=document.getElementById("insturment-select").value,a=document.getElementById("level-select").value;console.log(JSON.stringify({title:l,category:i,instrument:s,level:a,canton:e})),t+=6,setTimeout((()=>{d(l,i,s,a,e,t,!1)}),200)}}),{threshold:[1]}).observe(document.querySelector("#testHidden"))}()}window.addEventListener("load",(n=>{document.getElementById("display_event");let l=document.getElementById("index_map").getElementsByTagName("path"),i=document.getElementById("tooltip");function s(t){!function(){for(const e of l)e.style="fill : inherit;"}(),t.style="fill : red;",e=t.id}for(const e of l)e.addEventListener("click",(e=>{s(e.target)}),!1),e.addEventListener("mouseenter",(e=>{i.style.display="block"}),!1),e.addEventListener("mouseleave",(e=>{i.style.display="none"}),!1),e.addEventListener("mousemove",(e=>{if(i.innerHTML=e.target.id+"\n",null!==e.target.getAttribute("var")){let t=e.target.getAttribute("var");i.innerHTML+="( "+e.target.getAttribute("var"),i.innerHTML+=1===t?" annonce )":" annonces )"}else i.innerHTML+="( 0 annonce )";i.style.left=e.pageX+"px",i.style.top=e.pageY+"px"}),!1);s(document.getElementById("Rodez-1")),document.getElementById("display_event").innerHTML="",d(void 0,void 0,void 0,void 0,"Rodez-1"),document.getElementById("searchAdvertBtn").addEventListener("click",(()=>{t=0,document.getElementById("display_event").scrollTop=0,d(document.getElementById("inputSearchAdvert").value,document.getElementById("rubric-select").value,document.getElementById("insturment-select").value,document.getElementById("level-select").value,e)}))}))})();